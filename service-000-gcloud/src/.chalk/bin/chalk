#!/bin/sh

# shellcheck disable=SC2240
# shellcheck disable=SC1090

# set -x
# set -euo pipefail

. ~/.profile

if [ -z "$CHALK_STATUS" ]; then
    SCRIPTS_DEFAULT_PATH=/usr/src/service-000-gcloud/scripts/shell
    PROFILE_FILE=$HOME/.profile
    LIB_RESOURCES="UTILS_LIB=/usr/src/service-000-gcloud/scripts/shell/chalk/lib
        . \$UTILS_LIB/env.sh
        . \$UTILS_LIB/utils.sh
        . \$UTILS_LIB/prompt.sh
        "

    printf "%s" "$LIB_RESOURCES" >>"$PROFILE_FILE"
    sleep 5

    chalk init
    return 1
fi

if [ -z "$1" ] || [ "$1" = "help" ] || [ "$1" = "Help" ]; then
    shift
    . "$LIB_PATH"/help.sh "$@"
    return 1
else

    # handle chalk initialisation
    if [ "$1" = "init" ]; then
        chalk Help
        return 1
    fi

    # # handle gcloud commands
    # if [ "$1" = "gcloud" ]; then
    #     shift
    #     . "$SCRIPTS"/chalk/config/gcloud.sh "$@"
    #     clean_all_temp_files
    #     return 1
    # fi

    # # handle install / uninstall of services and resources
    # if [ "$1" = "install" ] || [ "$1" = "uninstall" ] || [ "$1" = "upgrade" ]; then
    #     SETUP_ACTION="$1"
    #     shift
    #     . "$SCRIPTS"/chalk/config/setup.sh "$@" "$SETUP_ACTION"
    #     clean_all_temp_files
    #     return 1
    # fi

    # handle prompt commands
    if [ "$1" = "prompt" ] || [ "$1" = "prompts" ]; then
        shift
        . "$LIB_PATH"/prompt.sh "$@"
        return 1
    fi

    # handle error commands
    if [ "$1" = "error" ] || [ "$1" = "errors" ]; then
        shift
        . "$LIB_PATH"/error.sh "$@"
        return 1
    fi

    # catch all errors
    . "$LIB_PATH"/error.sh 101
    return 1
fi
